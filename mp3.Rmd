---
title: "Mini-Project 3"
author: "Emma Livingston"
date: "November 13, 2017"
output: html_document
---

```{r setup, include=FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE, message = FALSE}
library(mdsr)
library(RMySQL)
library(tidyverse)
db <- dbConnect_scidb(dbname = "imdb")
```

##Genre Multiplicity

In this project, we looked at 


```{r}
num_genres <- db %>%
  dbGetQuery("SELECT title.title, title.id, production_year, info, sum(1) AS N
FROM movie_info
JOIN title ON title.id = movie_info.movie_id
WHERE info_type_id = 3 AND kind_id = 1
GROUP BY title.id
ORDER BY title, title.id;")
ggplot(data = num_genres, aes(x = production_year)) +
  geom_histogram()
```

```{r}
num_year <- db %>%
  dbGetQuery("SELECT production_year, info, sum(1) AS N, COUNT(DISTINCT title.id) 
FROM movie_info
JOIN title ON title.id = movie_info.movie_id
WHERE info_type_id = 3 AND kind_id = 1
GROUP BY production_year
ORDER BY title, title.id;")
```

```{r}
joined <- num_genres %>%
  inner_join(num_year, by = "production_year") %>%
  filter(production_year <= 2026) %>%
  group_by(production_year) %>%
  summarize(avg_genres = mean(N.x))
#It won't let me rename those ridiculous columns
```

```{r}
ggplot(data = joined, aes(x = production_year, y = avg_genres)) +
  geom_line(size = 1.2) +
  geom_vline(xintercept = 2017, col = "blue", linetype = 3) +
  geom_vline(xintercept = 1947, col = "blue", linetype = 3) +
  ylab("Average Number of Genres per Movie") +
  xlab("Production Year")
```


GitHub Repository: https://github.com/emmal73/mp3